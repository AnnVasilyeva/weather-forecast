(this["webpackJsonpweather-forecast"]=this["webpackJsonpweather-forecast"]||[]).push([[0],{16:function(e,t,a){},17:function(e,t,a){},20:function(e,t,a){"use strict";a.r(t);var c=a(1),n=a.n(c),r=a(9),s=a.n(r),i=(a(16),a(17),a(0));function o(){return Object(i.jsx)("header",{children:Object(i.jsxs)("h1",{className:"weather-card-title",children:[Object(i.jsx)("span",{className:"weather-card-title-up",children:"Weather"}),Object(i.jsx)("span",{className:"weather-card-title-down",children:"forecast"})]})})}var l=a(11),u=a(2);function j(){return Object(i.jsx)("div",{className:"forecast-empty-wrapper",children:Object(i.jsx)("div",{className:"forecast-empty-message",children:"Fill in all the fields and the weather will be displayed"})})}var d=a(3),f=a.n(d),m=a(7),b=a(10),h=function e(){var t=this;Object(b.a)(this,e),this.getResource=function(){var e=Object(m.a)(f.a.mark((function e(a){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(t._apiBase).concat(a));case 2:if((c=e.sent).ok){e.next=5;break}throw new Error("Something gone wrong");case 5:return e.next=7,c.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getWeekWeather=function(){var e=Object(m.a)(f.a.mark((function e(a){var c,n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=a.lat,n=a.lon,e.next=3,t.getResource("?lat=".concat(c,"&lon=").concat(n,"&units=metric&exclude=alerts,hourly,current&appid=").concat(t.apiKey));case 3:return r=e.sent,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getDayWeather=function(){var e=Object(m.a)(f.a.mark((function e(a){var c,n,r,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=a.lat,n=a.lon,r=a.dt,console.log(c,n,r),e.next=4,t.getResource("/timemachine?lat=".concat(c,"&lon=").concat(n,"&dt=").concat(Date.parse(r),"&appid=").concat(t.apiKey));case 4:return s=e.sent,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.getDay=function(e){var t=new Date(1e3*e),a=t.getDate(),c=t.getMonth(),n=t.getFullYear();return"".concat(a>10?a:"0"+a," ").concat(["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"][c]," ").concat(n)},this.data=[{name:"Samara",lat:"53.195873",lon:"50.100193",id:1},{name:"Tolyatty",lat:"53.507836",lon:"49.420393",id:2},{name:"Saratov",lat:"51.533557",lon:"46.034257",id:3},{name:"Cazan",lat:"55.796127",lon:"49.106405",id:4},{name:"Krasnodar",lat:"45.035470",lon:"38.975313",id:5}],this._apiBase="https://api.openweathermap.org/data/2.5/onecall",this.apiKey="662448886311aa69f48eddf74c980114"};function p(e){var t=e.item,a=e.onClick;return Object(i.jsx)("li",{className:"select-list-item city-item",onClick:function(){return a(t.id)},children:t.name})}function O(e){var t=e.weekSelected,a=e.weekForecast,n=e.citySelected,r=e.errorMessage,s=new h,o=s.data,l=Object(c.useState)(""),j=Object(u.a)(l,2),d=j[0],f=j[1],m=Object(c.useState)(!1),b=Object(u.a)(m,2),O=b[0],x=b[1],w=function(e){var a=o.find((function(t){return t.id===e}));if(a)return f((function(){return a.name})),x((function(){return!1})),s.getWeekWeather(a).then((function(e){return t(e)})).catch((function(e){return r(e)}))},v=function(e){var t=o.find((function(t){return t.id===e}));t&&(f((function(){return t.name})),x((function(){return!1})),n(t))},y=o.map((function(e,t){return Object(i.jsx)(p,{item:e,onClick:a?w:v},t)}));return Object(i.jsxs)("div",{className:"select-city-wrapper",children:[Object(i.jsx)("input",{type:"text",placeholder:"Select city",autoComplete:"off",className:"forecast-select forecast-select-city",name:"city",value:d,onClick:function(){return x(!O)}}),O&&Object(i.jsx)("ul",{className:"select-list select-city-list",children:y})]})}function x(e){var t=e.item,a=e.isDay,c=t.date,n=t.icon,r=t.temp;return Object(i.jsxs)("li",{className:a?"forecast-day-item":"forecast-week-item",children:[Object(i.jsx)("div",{className:"forecast-week-item-day",children:c}),Object(i.jsx)("div",{className:"forecast-week-item-icon",children:Object(i.jsx)("img",{src:n,alt:"weather icon"})}),Object(i.jsx)("div",{className:"forecast-week-item-temp",children:r>0?"+".concat(r,"\xba"):"-".concat(r,"\xba")})]})}function w(e){var t=e.errorMes;return Object(i.jsx)("div",{className:"error-message",children:t})}function v(e){var t=e.forecastList,a=e.errorMes,n=e.isDay,r=Object(c.useState)(0),s=Object(u.a)(r,2),o=s[0],l=s[1],j=new h,d=t.map((function(e){return Object(i.jsx)(x,{item:e,isDay:n},e.dt)})),f=t.slice(o,o+3).map((function(e){var t=function(e){return{date:j.getDay(e.dt),temp:Math.floor(e.temp.day),icon:"http://openweathermap.org/img/wn/".concat(e.weather[0].icon,"@2x.png")}}(e);return Object(i.jsx)(x,{item:t,isDay:n},e.dt)}));return Object(i.jsx)("div",{className:"forecast-week-list-wrapper",children:a?Object(i.jsx)(w,{errorMes:a}):Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("button",{type:"button",className:"forecast-week-list-btn prev_btn",onClick:function(){l(0===o?o:o-1)}}),Object(i.jsx)("ul",{className:"forecast-week-list",children:n?d:f}),Object(i.jsx)("button",{type:"button",className:"forecast-week-list-btn next_btn",onClick:function(){o===t.slice(o,o+3).length+1?l(o):l(o+1)}})]})})}var y=a(4);function g(e){var t=e.daySelected,a=e.value,c=function(e){var t=new Date(e),a=t.getDate(),c=t.getMonth()+1,n=t.getFullYear();return"".concat(n,"-").concat(c>10?c:"0"+c,"-").concat(a>10?a:"0"+a," ")},n=new Date,r=c(n.setDate(n.getDate()-1)),s=c(n.setDate(n.getDate()-5));return Object(i.jsx)("input",{type:"date",onChange:function(e){return t(e.target.value)},className:"forecast-select forecast-select-day active",value:a,name:"date",placeholder:"Select date",max:r,min:s})}function k(e){var t=e.weekForecast,a=e.dayForecast,n=e.errorMessage,r=new h,s=Object(c.useState)({dt:"",isEmpty:!0}),o=Object(u.a)(s,2),l=o[0],j=o[1],d=Object(c.useState)({lat:"",lon:"",isEmpty:!0}),f=Object(u.a)(d,2),m=f[0],b=f[1];Object(c.useEffect)((function(){l.isEmpty||m.isEmpty||p()}));var p=function(){r.getDayWeather(Object(y.a)(Object(y.a)({},m),l)).then((function(e){return a({date:r.getDay(e.current.dt),icon:"http://openweathermap.org/img/wn/".concat(e.current.weather[0].icon,"@2x.png"),temp:Math.floor(e.current.temp)})})).catch((function(e){return n(e)}))},x=Object(c.useState)(!1),w=Object(u.a)(x,2),v=w[0],k=w[1];return Object(i.jsxs)("div",{className:"forecast-select-wrapper",children:[Object(i.jsx)(O,{weekForecast:t,citySelected:function(e){var t={lat:e.lat,lon:e.lon,isEmpty:!1};b(Object(y.a)(Object(y.a)({},m),t))}}),Object(i.jsx)("div",{className:"select-date-wrapper",onClick:function(){k(!0)},children:v?Object(i.jsx)(g,{daySelected:function(e){j(Object(y.a)(Object(y.a)({},l),{},{dt:e,isEmpty:!1}))},value:l.dt}):Object(i.jsx)("div",{className:"forecast-select forecast-select-day",children:"Select date"})})]})}function N(e){var t=e.weekForecast,a=Object(c.useState)(!1),n=Object(u.a)(a,2),r=n[0],s=n[1],o=Object(c.useState)([]),d=Object(u.a)(o,2),f=d[0],m=d[1],b=Object(c.useState)(!1),h=Object(u.a)(b,2),p=h[0],x=h[1],w=Object(c.useState)(""),y=Object(u.a)(w,2),g=y[0],N=y[1],S=function(e){s(!0),N(e.message)};return Object(i.jsx)("li",{className:"card-list-item",children:Object(i.jsxs)("div",{className:"forecast",children:[Object(i.jsx)("h2",{className:"forecast-title",children:t?"7 Days Forecast":"Forecast for a Date in the Past"}),t?Object(i.jsx)(O,{weekSelected:function(e){s(!0),m(e.daily)},weekForecast:t,errorMessage:S}):Object(i.jsx)(k,{weekForecast:t,dayForecast:function(e){s(!0),m([].concat(Object(l.a)(f),[e])),x(!0)},errorMessage:S}),r?Object(i.jsx)(v,{forecastList:f,errorMes:g,isDay:p}):Object(i.jsx)(j,{})]})})}var S=function(){return Object(i.jsx)("div",{className:"container",children:Object(i.jsx)("main",{className:"weather-card",children:Object(i.jsxs)("div",{className:"weather-card-wrapper",children:[Object(i.jsx)(o,{}),Object(i.jsxs)("ul",{className:"card-list",children:[Object(i.jsx)(N,{weekForecast:!0}),Object(i.jsx)(N,{weekForecast:!1})]}),Object(i.jsx)("footer",{className:"footer-copyright",children:"\u0421 \u043b\u044e\u0431\u043e\u0432\u044c\u044e \u043e\u0442 mercury development"})]})})})},D=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,21)).then((function(t){var a=t.getCLS,c=t.getFID,n=t.getFCP,r=t.getLCP,s=t.getTTFB;a(e),c(e),n(e),r(e),s(e)}))};s.a.render(Object(i.jsx)(n.a.StrictMode,{children:Object(i.jsx)(S,{})}),document.getElementById("root")),D()}},[[20,1,2]]]);
//# sourceMappingURL=main.4fc48a7d.chunk.js.map